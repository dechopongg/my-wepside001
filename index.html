<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Share Flex Message</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: #eef2ff;
    }
    .msg {
      display: none;
      padding: 20px 28px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 20px rgba(0,0,0,.15);
      font-size: 18px;
      text-align: center;
    }
    #errorMsg { color: #d9534f; }
  </style>
</head>

<body>
  <div class="msg" id="loadingMsg">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏ä‡∏£‡πå Flex Message...</div>
  <div class="msg" id="successMsg">‚úÖ ‡πÅ‡∏ä‡∏£‡πå Flex Message ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</div>
  <div class="msg" id="errorMsg">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</div>

  <script>
    // ================= FLEX MESSAGE =================
    const flexMessage = {
      type: "flex",
      altText: "üìö ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ô‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô",
      contents: {
        type: "carousel",
        contents: [
          {
            type: "bubble",
            body: {
              type: "box",
              layout: "vertical",
              contents: [
                {
                  type: "image",
                  url: "https://img5.pic.in.th/file/secure-sv1/1334f31ba74cf7569.jpg",
                  size: "full",
                  aspectMode: "cover",
                  aspectRatio: "2.3:3",
                  animated: true
                },
                {
                  type: "button",
                  action: {
                    type: "uri",
                    label: "‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",
                    uri: "https://liff.line.me/2008827673-1tC1xai2"
                  },
                  position: "absolute",
                  offsetTop: "80%",
                  offsetStart: "30%"
                }
              ]
            }
          }
        ]
      }
    };
    // =================================================

    function show(id) {
      document.querySelectorAll(".msg").forEach(el => el.style.display = "none");
      document.getElementById(id).style.display = "block";
    }

    async function run() {
      try {
        show("loadingMsg");

        await liff.init({
          liffId: "2008827673-1tC1xai2"   // üî¥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ñ‡πâ‡∏≤ LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á
        });

        if (!liff.isLoggedIn()) {
          liff.login();
          return;
        }

        if (!liff.isApiAvailable("shareTargetPicker")) {
          throw new Error("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ LINE ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠");
        }

        const result = await liff.shareTargetPicker([flexMessage]);

        if (result) {
          show("successMsg");
          setTimeout(() => liff.closeWindow(), 2000);
        } else {
          liff.closeWindow();
        }

      } catch (err) {
        console.error(err);
        document.getElementById("errorMsg").innerText = "‚ùå " + err.message;
        show("errorMsg");
      }
    }

    run();
  </script>
</body>
</html>